/*!
 * stuQuery version 1.0.1
 */
var eventcache={};function S(o){function q(g,i){var t=new Array();var b,a,c,f,h,d;if(i.indexOf(":eq")>=0){b=i.split(" ");for(c=0;c<b.length;c++){if(c==0){d=s(g,b[c])}else{a=new Array();for(f=0;f<d.length;f++){a=a.concat(s(d[f],b[c]))}d=a.splice(0)}}}else{d=g.querySelectorAll(i)}for(h=0;h<d.length;h++){t.push(d[h])}return t}function s(c,d){var f=-1;var a=new Array();if(d.indexOf(":eq")>0){var b=d.replace(/(.*)\:eq\(([0-9]+)\)/,"$1 $2").split(" ");d=b[0];f=parseInt(b[1])}if(d[0]=="."){els=c.getElementsByClassName(d.substr(1))}else{if(d[0]=="#"){els=c.getElementById(d.substr(1))}else{els=c.getElementsByTagName(d)}}if(!els){els=[]}if(els.nodeName&&els.nodeName=="SELECT"){a.push(els)}else{if(typeof els.length!=="number"){els=[els]}for(k=0;k<els.length;k++){a.push(els[k])}if(f>=0&&a.length>0){if(f<a.length){a=[a[f]]}else{a=[]}}}return a}function m(d,a){var c=false;if(a[0]=="."){a=a.substr(1);for(var b=0;b<d.classList.length;b++){if(d.classList[b]==a){return true}}}else{if(a[0]=="#"){if(d.id==a.substr(1)){return true}}else{if(d.tagName==a.toUpperCase()){return true}}}return false}function r(b){var a;if(typeof b==="string"){this.e=q(document,b)}else{if(typeof b==="object"){this.e=(typeof b.length=="number")?b:[b]}}this.length=(this.e?this.e.length:0);return this}r.prototype.ready=function(a){/in/.test(document.readyState)?setTimeout("S(document).ready("+a+")",9):a()};r.prototype.html=function(a){if(typeof a==="number"){a=""+a}if(typeof a!=="string"&&this.e.length==1){return this.e[0].innerHTML}if(typeof a==="string"){for(var b=0;b<this.e.length;b++){this.e[b].innerHTML=a}}return this};r.prototype.append=function(a){if(!a&&this.e.length==1){return this.e[0].innerHTML}if(a){for(var b=0;b<this.e.length;b++){this.e[b].innerHTML+=a}}return this};r.prototype.prepend=function(b){if(!b&&this.e.length==1){return this.e[0].innerHTML}if(b){for(var a=0;a<this.e.length;a++){this.e[a].innerHTML=b+this.e[a].innerHTML}}return this};r.prototype.before=function(f){var c=document.createElement("div");c.innerHTML=f;var d=c.childNodes;for(var a=0;a<el.length;a++){for(var b=0;b<d.length;b++){el[a].parentNode.insertBefore(d[b],el[a])}}return this};r.prototype.after=function(a){for(var b=0;b<this.e.length;b++){this.e[b].insertAdjacentHTML("afterend",a)}return this};function n(c,a){if(c&&c.length>0){for(var b=0;b<c.length;b++){if(c[b].node==a){return{success:true,match:b}}}}return{success:false}}function p(d,a,b,c,f){if(!eventcache[a]){eventcache[a]=new Array()}eventcache[a].push({node:d,fn:b,fn2:c,data:f})}function e(a){if(eventcache[a.type]){var b=n(eventcache[a.type],a.currentTarget);if(b.success){if(b.match.data){a.data=eventcache[a.type][b.match].data}return{fn:eventcache[a.type][b.match].fn,data:a}}}return function(){return{fn:""}}}r.prototype.off=function(a){if(typeof Element.prototype.removeEventListener!=="function"){Element.prototype.removeEventListener=function(f,i){if(!oListeners.hasOwnProperty(f)){return}var t=oListeners[f];for(var d=-1,u=0;u<t.aEls.length;u++){if(t.aEls[u]===this){d=u;break}}if(d===-1){return}for(var g=0,h=t.aEvts[d];g<h.length;g++){if(h[g]===i){h.splice(g,1)}}}}for(var b=0;b<this.e.length;b++){var c=n(eventcache[a],this.e[b]);if(c.success){this.e[b].removeEventListener(a,eventcache[a][c.match].fn2,false);eventcache[a].splice(c.match,1)}}return this};r.prototype.on=function(a,g,b){a=a||window.event;this.cache=[4,5,6];if(typeof g==="function"&&!b){b=g;g=""}if(typeof b!=="function"){return this}if(this.e.length>0){var f=this;var d=function(i){var h=e({currentTarget:this,type:a,data:g,originalEvent:i});if(typeof h.fn==="function"){return h.fn.call(f,h.data)}};for(var c=0;c<this.e.length;c++){p(this.e[c],a,b,d,g);if(this.e[c].addEventListener){this.e[c].addEventListener(a,d,false)}else{if(this.e[c].attachEvent){this.e[c].attachEvent(a,d)}}}}return this};r.prototype.trigger=function(a){var b;if(document.createEvent){b=document.createEvent("HTMLEvents");b.initEvent(a,true,true)}else{b=document.createEventObject();b.eventType=a}b.eventName=a;for(var c=0;c<this.e.length;c++){if(document.createEvent){this.e[c].dispanelEvent(b)}else{this.e[c].fireEvent("on"+b.eventType,b)}}return this};r.prototype.focus=function(){if(this.e.length==1){this.e[0].focus()}return this};r.prototype.blur=function(){if(this.e.length==1){this.e[0].blur()}return this};r.prototype.remove=function(){if(!this.e){return this}for(var a=this.e.length-1;a>=0;a--){if(!this.e[a]){return}if(typeof this.e[a].remove==="function"){this.e[a].remove()}else{if(typeof this.e[a].parentElement.removeChild==="function"){this.e[a].parentElement.removeChild(this.e[a])}}}return S(this.e)};r.prototype.hasClass=function(b){var c=true;for(var a=0;a<this.e.length;a++){if(!this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){c=false}}return c};r.prototype.toggleClass=function(b){for(var a=0;a<this.e.length;a++){if(this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=this.e[a].className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g")," ").replace(/ $/,"")}else{this.e[a].className=(this.e[a].className+" "+b).replace(/^ /,"")}}return S(this.e)};r.prototype.addClass=function(b){for(var a=0;a<this.e.length;a++){if(!this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=(this.e[a].className+" "+b).replace(/^ /,"")}}return S(this.e)};r.prototype.removeClass=function(b){for(var a=0;a<this.e.length;a++){while(this.e[a].className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))){this.e[a].className=this.e[a].className.replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g")," ").replace(/ $/,"").replace(/^ /,"")}}return S(this.e)};r.prototype.css=function(a){var h;for(var b=0;b<this.e.length;b++){h={};var i=this.e[b].getAttribute("style");if(i){var d=this.e[b].getAttribute("style").split(";");for(var c=0;c<d.length;c++){var g=d[c].split(":");if(g.length==2){h[g[0]]=g[1]}}}if(typeof a==="object"){for(key in a){h[key]=a[key]}var f="";for(key in h){if(f){f+=";"}if(h[key]){f+=key+":"+h[key]}}this.e[b].setAttribute("style",f)}}if(this.e.length==1&&typeof a==="string"){return h[a]}return S(this.e)};r.prototype.parent=function(){var a=[];for(var b=0;b<this.e.length;b++){a.push(this.e[b].parentElement)}return S(a)};r.prototype.children=function(a){if(typeof a==="string"){var d=[];for(var c=0;c<this.e.length;c++){for(var b=0;b<this.e[c].children.length;b++){if(m(this.e[c].children[b],a)){d.push(this.e[c].children[b])}}}return S(d)}else{for(var c=0;c<this.e.length;c++){this.e[c]=(this.e[c].children.length>a?this.e[c].children[a]:this.e[c])}return S(this.e)}};r.prototype.find=function(c){var a=[];var d=new Array();for(var b=0;b<this.e.length;b++){d=d.concat(q(this.e[b],c))}return S(d)};r.prototype.attr=function(d,a){var b=[];for(var c=0;c<this.e.length;c++){b.push(this.e[c].getAttribute(d));if(typeof a==="string"||typeof a==="number"){if(a){this.e[c].setAttribute(d,a)}else{this.e[c].removeAttribute(d)}}}if(b.length==1){b=b[0]}if(typeof a==="undefined"){return b}else{return S(this.e)}};r.prototype.prop=function(d,a){var b=[];for(var c=0;c<this.e.length;c++){b.push(this.e[c].getAttribute(d));if(typeof a==="boolean"){if(a){this.e[c].setAttribute(d,d)}else{this.e[c].removeAttribute(d)}}}if(b.length==1){b=b[0]}return b};r.prototype.clone=function(){var a=document.createElement("div");a.appendChild(this.e[0].cloneNode(true));return a.innerHTML};r.prototype.replaceWith=function(c){var b=document.createElement("span");b.innerHTML=c;var a=S(this.e);for(var d=0;d<this.e.length;d++){a.e[0].parentNode.replaceChild(b,a.e[0])}return a};r.prototype.ajax=function(a,b){if(typeof a!=="string"){return false}if(!b){b={}}b.url=a+(typeof b.cache==="boolean"&&!b.cache?"?"+(new Date()).valueOf():"");var f=(window.XMLHttpRequest)?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");f.addEventListener("load",d);f.addEventListener("error",c);function d(h){if(f.status===200){b.header=f.getAllResponseHeaders();if(typeof b.complete==="function"){b.complete.call((b["this"]?b["this"]:this),(b.dataType=="json")?JSON.parse(f.responseText):f.responseText,b)}}else{c(h)}}function c(h){if(typeof b.error==="function"){b.error.call((b["this"]?b["this"]:this),h,b)}}try{f.open("GET",a)}catch(g){c(g)}try{f.send()}catch(g){c(g)}return this};r.prototype.loadJSON=function(b,a,c){if(!c){c={}}c.dataType="json";c.complete=a;this.ajax(b,c);return this};return new r(o)}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1000/60)}})();
/*!
 * ODI Leeds Dashboard (version 1.0.1)
 */
function Dashboard(m){if(!m){m={}}this.panels=new Array();this.year="";this.duration=1000;this.config={};this.panellookup={};var b={};this.setup=function(t){if(!t){t={}}if(typeof t.year==="string"){this.year=S(t.year).e[0].value}if(t.config){this.config=t.config}var q=0;for(var u in this.config){var s=S("#"+u);this.panellookup[u]=q;this.panels[q]={el:s,updateable:new Array(),id:u,config:this.config[u]};if(this.config[u].data){var r=this.config[u].data;if(!b[r]){S().ajax(r,{complete:h,"this":this,error:n,i:q,me:this,cache:false})}else{h(this.panels[b[r]].data,{i:q,me:this})}this.panels[q].el.on("click",{me:this,i:q},function(p){location.href="#"+p.data.me.panels[p.data.i].id})}q++}S("#range").on("change",{me:this},function(p){p.data.me.year=p.currentTarget.value;p.data.me.update()})};function d(q,p){z="0";q=q+"";l=q.length;return l>=p?q:new Array(p-l+1).join(z)+q}function o(r,u,s,q){if(typeof u!=="number"){u=r.html();if(u){u=parseFloat(u)}r.html("")}if(!q){q=""}var w=new Date();var p;function t(){var v=new Date();var x=(v-w)/s;if(x<1){p=c(Math.round(u*x));r.html(q+p);requestAnimFrame(t)}else{r.html(q+c(u))}}if(typeof u==="number"){t()}return}function f(r,s,t){if(t>0){e(r,s,t)}else{var p="<ol>";for(var q=0;q<s.length;q++){p+="<li>"+s[q]+"</li>"}p+="</ol>";r.html(p)}}function e(q,r,s){if(!r){return}var u=new Date();var p=-1;function t(){var w=new Date();var y=(w-u)/s;var A=Math.floor(r.length*y);var v=new Array();if(A>p){for(var x=0;x<A;x++){v.push(r[x])}}if(y<1){f(q,v);requestAnimFrame(t)}else{f(q,r)}}t();return}function g(r){var s=r.getBoundingClientRect();var q=window.pageYOffset?window.pageYOffset:(document.documentElement?document.documentElement.scrollTop:(document.body?document.body.scrollTop:0));var p=window.pageXOffset?window.pageXOffset:(document.documentElement?document.documentElement.scrollLeft:(document.body?document.body.scrollLeft:0));return{top:(s.top+q),left:(s.left+p),width:(s.width),height:(s.height)}}function h(s,p){if(typeof s==="string"){s=s.replace(/\r/,"");s=s.split(/[\n]/)}p.me.panels[p.i].data=s;var r=p.header.split(/[\n\r]/);var t={};for(var q=0;q<r.length;q++){if(r[q]){j=r[q].indexOf(":");t[r[q].substr(0,j)]=r[q].substr(j+1).replace(/^ */,"")}}p.me.panels[p.i].head=t;p.me.updatePanel(p.i);b[p.url]=p.i;if(p.me.panels[p.i].id==p.me.anchor){this.navigate({},p.me.anchor)}return}function n(p){console.log("fail",p)}function c(p){if(typeof p!=="number"){return p}if(p>10000000){return Math.round(p/1000000)+"M"}if(p>1000000){return(p/1000000).toFixed(1)+"M"}if(p>100000){return Math.round(p/1000)+"k"}if(p>10000){return Math.round(p/1000)+"k"}return p}this.update=function(){for(var p=0;p<this.panels.length;p++){if(this.panels[p]&&this.panels[p].data){this.updatePanel(p)}}};this.updatePanel=function(M){var F,J,E;if(this.panels[M]){var Z=new Array();if(!this.panels[M].data){return}for(var K=1;K<this.panels[M].data.length;K++){E=this.panels[M].data[K].split(/\,/);Z.push(E)}this.panels[M].el=S("#"+this.panels[M].id);for(var V in this.panels[M].config.els){var N=this.panels[M].el.find(V);var u=this.panels[M].config.els[V];if(N.length==0){continue}if(V==".lastupdated"&&this.panels[M].head["Last-Modified"]){var X=new Date(this.panels[M].head["Last-Modified"]);N.html(X.getUTCFullYear()+"-"+d(X.getUTCMonth()+1,2)+"-"+d(X.getUTCDate(),2));continue}if(u.text){N.html(u.text);continue}var w=this.panels[M].config.start||"";var U=this.panels[M].config.end||"";var x=u.col||"";var ac=u.img||"";var A=u.row||"";if(A){if(A=="all"){if(u.type=="list"){var W=new Array();var Y=parseInt(u.url);for(var K=0;K<Z.length;K++){var I=Z[K][w-1];var V=(new Date()).toISOString();if(U&&Z[K][U-1]){V=Z[K][U-1]}if(this.inDateRange(I,V)){W.push((Y?'<a href="'+Z[K][Y-1]+'">':"")+(Z[K][ac-1]?'<img src="data/'+Z[K][ac-1]+'" alt="'+Z[K][x-1]+'" title="'+Z[K][x-1]+'" />':Z[K][x-1])+(Y?"</a>":""))}}this.panels[M].updateable.push({el:V,n:N,list:W,duration:(u.animate?this.duration:0)})}else{if(u.type=="graph"){var L;var H=0;var P={};var t,v,I;function T(p){return(p.length==4)?{y:parseInt(p)}:{y:parseInt(p.substr(0,4)),m:parseInt(p.substr(5,2))}}for(var K=0;K<Z.length;K++){I=Z[K][w-1];if(this.inDateRange(I)){if(!t){t=I}}else{if(t&&!v){v=Z[K-1][w-1]}}}if(!v){v=Z[Z.length-1][w-1]}t=T(t);v=T(v);monthly=(t.m>0);for(var D=t.y;D<=v.y;D++){if(monthly){for(var O=1;O<=12;O++){P[D+"-"+(O<10?"0":"")+O]=0}}else{P[D]=0}}var G=0;for(var ab in P){G++}var Q=0.5*("innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight);for(var K=0;K<Z.length;K++){t=T(Z[K][w-1]);ab=t.y+(monthly?"-"+(t.m<10?"0":"")+t.m:"");if(typeof P[ab]==="number"){P[ab]+=parseFloat(Z[K][x-1])}}for(var ab in P){if(P[ab]>H){H=P[ab]}}var C='<div class="grid" style="height:'+Q+'px;">';var q=a(0,H);for(var R=0;R<q.max;R+=q.inc){C+='<div class="line" style="bottom:'+(Q*R/H)+'px;"><span>'+(this.panels[M].config.units||"")+c(R)+"</span></div>"}C+="</div>";C+='<table><tr style="vertical-align:bottom;">';for(var ab in P){C+='<td style="width:'+(100/G)+'%;"><div class="bar" title="'+ab+": "+(this.panels[M].config.units||"")+c(P[ab])+'" style="height:'+(Q*P[ab]/H)+'px;"></div>'+((ab.indexOf("-01")>0||ab.indexOf("-")==-1)?'<span class="date">'+ab.substr(0,4)+"</span>":"")+"</td>"}C+="</tr></table>";N.html(C)}}continue}else{if(A=="last"){A=Z.length;if(w){for(var K=0;K<Z.length;K++){if(this.inDateRange(Z[K][w-1])){A=K+1}}}}else{A=parseInt(A)}}val=Z[A-1][x-1];if(u.animate){o(N,val,this.duration)}else{N.html(val)}}else{var B=u.op;var F="";if(B&&x){var aa=0;for(var K=0;K<Z.length;K++){var I=Z[K][w-1];var V=(new Date()).toISOString();if(U&&Z[K][U-1]){V=Z[K][U-1]}if(this.inDateRange(I,V)){if(B=="sum"){aa+=parseInt(Z[K][x-1])}else{if(B=="count"){aa++}}}}if(u.animate){o(N,aa,this.duration,this.panels[M].config.units)}else{N.html((this.panels[M].config.units||"")+c(aa))}}}}}};this.inDateRange=function(t,p){var q=parseInt(t.substr(0,4));var r=(p?parseInt(p.substr(0,4)):q);if(!this.year){return true}if(q<=this.year&&r>=this.year){return true}else{return false}};this.resize=function(){var q=S(".moreinfo");if(q.length==1){var p="innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight;S(".moreinfo").css({left:"0px",top:"0px",width:document.body.offsetWidth+"px",height:p+"px"})}return this};this.navigate=function(s,p){if(!p){p=location.href.split("#")[1]}var r=this.panellookup[p];S(".moreinfo").remove();if(typeof r==="number"){for(var q=0;q<this.panels[r].updateable.length;q++){f(this.panels[r].updateable[q].n,this.panels[r].updateable[q].list,this.panels[r].updateable[q].duration)}this.panels[r].el=S("#"+this.panels[r].id);var t=g(this.panels[r].el.e[0]);S(".main").after('<div class="moreinfo '+this.panels[r].config["class"]+'"></div>');S("body").css({"overflow-y":"hidden"});S(".moreinfo").html('<div class="close">&times;</div>'+this.panels[r].el.html()).css({width:t.width+"px",height:t.height+"px",left:t.left+"px",top:t.top+"px"}).css({left:"0px",top:"0px",width:document.body.offsetWidth+"px",height:("innerHeight" in window?window.innerHeight:document.documentElement.offsetHeight)+"px"});S(".moreinfo .close").on("click",{me:this},function(u){location.href=u.data.me.href+"#top"})}else{S("body").css({"overflow-y":""})}return this};this.pushstate=!!(window.history&&history.pushState);this.href=location.href.split("#")[0];this.anchor=location.href.split("#")[1];var i=this;window.addEventListener("resize",function(p){i.resize()});window[(this.pushstate)?"onpopstate":"onhashchange"]=function(p){i.navigate(p)};function a(v,w){var q=w-v;var t=10;var p=Math.pow(t,Math.floor(Math.log(q)/Math.log(t)));p*=2;var s=(Math.floor(w/p))*p;if(s<w){s+=p}var u=s;var r=0;do{r++;u-=p}while(u>v);if(Math.abs(u)<1e-15){u=0}while(r<3){p/=2;if((u+p)<=v){u+=p}if((s-p)>=w){s-=p}r=r*2}return{min:u,max:s,inc:p,range:s-u}}return this};